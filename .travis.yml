warnings_are_errors: false
language: r
sudo: required

before_install:
  - sudo apt-get install build-essential gcc-multilib g++-multilib cmake python3-setuptools libffi-dev

r_github_packages:
  - jimhester/covr
  
before_script:
  - R -e "devtools::load_all()"

r_packages:
  - Rcpp
  - RInside
  - RcppArmadillo
  - devtools
  - roxygen2

after_success:
  - Rscript -e 'devtools::load_all();devtools::install();devtools::test()'
  
r_check_args: '--as-cran --use-valgrind'

addons:
  apt:
    packages:
      - valgrind
      
env:
  - VALGRIND_OPTS='--leak-check=full --track-origins=yes'

script: 
  - |
    travis_wait 160 R CMD build --no-resave-data --no-build-vignettes .
    travis_wait 160 R CMD check "${PKG_TARBALL}" --as-cran --no-build-vignettes --use-valgrind; CHECK_RET=$?

r_build_args: --no-resave-data --no-build-vignettes
    